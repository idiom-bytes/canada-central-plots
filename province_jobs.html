<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Provincial Employment | Canada Central</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
  <style>
    :root {
      --color-burgundy: #6B3838;
      --color-teal: #3A5F6F;
      --color-tan: #C49A6C;
      --color-purple: #7C5A9D;
      --color-cream: #F0ECE3;
      --color-cream-dark: #E8E2D5;
      --color-beige: #D8D1C2;
      --color-beige-dark: #C8C0B0;
      --color-white: #FEFEFE;
      --color-text-primary: #2D2D2D;
      --color-text-secondary: #5A5A5A;
      --color-text-tertiary: #8A8A8A;
      --shadow-card: 0 2px 8px 0 rgba(0,0,0,0.08);
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
    }
    html,body{height:100%;margin:0}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;background:var(--color-cream);color:var(--color-text-primary);display:flex;flex-direction:column}
    /* Navbar */
    .navbar{padding:0.75rem 1rem;display:flex;justify-content:space-between;align-items:center;background:var(--color-cream);border-bottom:1px solid var(--color-beige)}
    .navbar-brand{display:flex;align-items:center;gap:0.5rem;font-size:1rem;font-weight:700;color:var(--color-text-primary);text-decoration:none}
    .navbar-brand:hover{color:var(--color-teal)}
    .navbar-links{display:flex;gap:1.5rem;font-size:0.875rem;font-weight:600}
    .navbar-links a{color:var(--color-text-secondary);text-decoration:none;transition:color .2s}
    .navbar-links a:hover{color:var(--color-text-primary)}
    .navbar-links a.active{color:var(--color-text-primary)}
    /* Page */
    .page{flex:1;display:flex;flex-direction:column;padding:1rem;box-sizing:border-box}
    @media(min-width:640px){.page{padding:1.25rem 1.5rem}}
    .content{max-width:1400px;margin:0 auto;width:100%;display:flex;flex-direction:column;flex:1;min-height:0}
    /* Title */
    .page-title{font-size:1.5rem;font-weight:700;color:var(--color-text-primary);line-height:1.3;margin:0 0 0.25rem}
    @media(min-width:640px){.page-title{font-size:1.875rem}}
    .page-subtitle{font-size:0.75rem;color:var(--color-text-tertiary);margin:0 0 1rem}
    @media(min-width:640px){.page-subtitle{font-size:0.875rem}}
    /* Controls */
    .controls{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap;align-items:center}
    .controls label{color:var(--color-text-secondary);font-weight:500;font-size:0.875rem;white-space:nowrap}
    .form-select{padding:0.5rem 0.75rem;font-size:0.75rem;border:1px solid var(--color-beige-dark);border-radius:var(--radius-md);background:var(--color-white)}
    @media(min-width:640px){.form-select{padding:0.625rem 1rem;font-size:0.875rem}}
    .btn-filter{padding:0.5rem 0.75rem;border-radius:var(--radius-md);font-size:0.75rem;font-weight:500;cursor:pointer;border:1px solid transparent;transition:all .2s;background:var(--color-beige);color:var(--color-text-primary);border-color:var(--color-beige-dark)}
    @media(min-width:640px){.btn-filter{padding:0.625rem 1rem}}
    .btn-filter:hover{background:var(--color-beige-dark);border-color:var(--color-text-secondary)}
    .btn-filter.active{background:var(--color-teal);color:var(--color-white);border-color:var(--color-teal)}
    /* Province chips */
    .provinces{display:flex;gap:6px;margin-bottom:12px;flex-wrap:wrap;align-items:center}
    .chip{padding:4px 10px;border-radius:9999px;cursor:pointer;font-size:0.6875rem;font-weight:600;border:2px solid;opacity:.3;transition:opacity .15s}
    @media(min-width:640px){.chip{padding:5px 12px;font-size:0.75rem}}
    .chip.on{opacity:1}
    .chip-toggle{padding:4px 10px;border-radius:9999px;cursor:pointer;font-size:0.6875rem;font-weight:600;background:var(--color-beige);color:var(--color-text-secondary);border:1px solid var(--color-beige-dark)}
    .chip-toggle:hover{background:var(--color-beige-dark)}
    /* Chart card */
    .chart-card{background:var(--color-white);border-radius:var(--radius-lg);box-shadow:var(--shadow-card);border-top:4px solid var(--color-text-secondary);flex:1;min-height:250px;position:relative;padding:20px}
    canvas{position:absolute;top:20px;left:20px;right:20px;bottom:20px}
  </style>
</head>
<body>
  <nav class="navbar">
    <a class="navbar-brand" href="https://canada-central.com">Canada Central</a>
    <div class="navbar-links">
      <a href="https://canada-central.com">Home</a>
      <a class="active" href="#">Plots</a>
    </div>
  </nav>

  <div class="page">
    <div class="content">
      <h1 class="page-title">Provincial Employment: Public vs Private Sectors</h1>
      <p class="page-subtitle">Monthly employment data by province (Jan 2020 - Aug 2025). Source: Statistics Canada LFS.</p>

      <div class="controls">
        <label>Sector:</label>
        <select id="sector" class="form-select" onchange="update()">
          <option value="both">Both Sectors</option>
          <option value="private" selected>Private Only</option>
          <option value="public">Public Only</option>
        </select>
        <label>View:</label>
        <button class="btn-filter" onclick="setView('mom', event)">MoM %</button>
        <button class="btn-filter active" onclick="setView('indexed', event)">Indexed</button>
        <button class="btn-filter" onclick="setView('absolute', event)">Absolute</button>
        <button class="btn-filter" onclick="setView('share', event)">Share %</button>
      </div>
      <div class="provinces" id="provinces"></div>

      <div class="chart-card">
        <canvas id="chart"></canvas>
      </div>
    </div>
  </div>

  <script>
    const provincialData = {
      "Alberta": {"private":[1517.6,1521.6,1408.0,1180.1,1199.9,1311.2,1354.4,1362.1,1388.0,1395.8,1409.4,1399.4,1405.0,1432.2,1454.8,1449.7,1442.9,1450.6,1459.7,1464.9,1492.9,1477.5,1494.5,1523.6,1529.4,1545.1,1546.6,1564.0,1564.3,1570.8,1589.3,1584.3,1591.8,1587.1,1588.8,1583.6,1621.6,1611.9,1619.0,1608.1,1633.1,1641.3,1643.9,1658.5,1628.6,1663.3,1673.9,1692.8,1679.7,1696.9,1708.3,1712.8,1700.7,1713.2,1721.5,1728.9,1725.4,1746.1,1740.2,1752.9,1750.4,1746.4,1718.2,1734.6,1746.8,1773.1,1757.3,1728.9],"public":[418.3,418.7,409.9,407.8,387.9,391.4,402.9,403.9,424.8,433.6,431.8,431.0,433.9,434.9,442.4,439.6,442.4,435.9,427.9,445.7,452.7,449.7,447.8,449.1,441.3,440.6,440.7,440.2,444.4,446.6,434.9,440.1,444.4,437.1,437.6,439.1,437.5,441.8,443.2,445.4,448.9,451.3,456.2,442.8,452.1,452.8,452.1,448.7,458.5,461.1,455.3,453.4,444.4,451.5,455.4,452.7,443.2,438.8,446.5,471.4,471.9,475.0,477.6,478.0,467.3,465.3,465.8,487.0]},
      "British Columbia": {"private":[1755.8,1761.4,1586.5,1352.9,1406.6,1509.7,1579.6,1600.0,1658.8,1669.4,1687.4,1671.6,1677.3,1692.1,1711.4,1705.1,1709.3,1752.7,1754.1,1786.8,1791.4,1785.4,1787.4,1780.0,1777.5,1789.8,1795.7,1800.7,1814.9,1797.6,1810.3,1816.4,1814.1,1813.7,1815.6,1820.7,1819.0,1818.9,1825.6,1816.6,1817.8,1809.0,1814.9,1820.4,1826.3,1830.3,1847.2,1862.2,1868.3,1856.7,1837.8,1858.7,1865.1,1874.1,1857.9,1866.9,1849.7,1869.1,1868.8,1866.3,1876.6,1873.2,1870.5,1872.1,1881.0,1875.4,1876.9,1880.6],"public":[459.5,460.1,458.3,438.8,458.9,469.8,453.1,467.9,488.4,507.9,507.1,517.0,516.7,527.3,511.5,504.9,499.2,518.8,524.6,518.3,527.2,520.6,524.4,523.4,530.2,535.8,527.0,520.5,526.2,528.8,535.9,538.1,553.7,556.5,564.1,558.0,554.1,549.5,556.9,562.8,577.2,573.3,568.3,584.3,590.5,584.0,585.3,588.1,592.3,599.0,598.6,613.9,599.5,592.2,606.7,600.4,598.3,590.3,589.2,602.8,601.5,599.4,610.1,611.7,618.2,623.5,609.0,601.7]},
      "Manitoba": {"private":[415.7,415.4,387.8,333.2,349.3,378.1,386.1,396.5,406.3,403.7,393.4,386.0,391.5,402.8,407.1,413.8,409.5,404.7,418.9,416.8,422.5,425.5,423.6,427.1,429.9,434.6,433.9,435.0,428.4,425.9,429.9,424.2,427.8,433.3,436.7,435.1,439.9,445.7,446.1,444.1,455.0,454.5,450.4,455.0,461.4,459.2,457.1,459.9,464.1,455.9,455.0,458.7,461.5,465.3,460.1,464.1,467.5,466.5,471.4,466.0,467.0,469.5,465.4,470.7,467.5,474.1,470.9,467.7],"public":[166.5,166.8,165.1,160.4,154.6,156.9,159.8,161.4,165.5,165.3,161.2,159.5,161.4,163.4,164.5,167.0,168.4,168.2,167.0,166.3,170.8,172.8,176.8,177.5,176.2,179.9,176.2,178.9,181.4,184.1,182.5,180.1,184.4,184.1,182.6,186.5,185.5,180.8,185.9,184.4,180.8,181.0,181.6,181.7,182.1,181.8,183.3,181.1,183.6,184.1,183.4,183.7,186.1,186.9,186.9,186.8,187.7,187.2,189.4,188.1,186.9,184.9,186.6,187.5,183.3,184.9,188.9,185.1]},
      "New Brunswick": {"private":[240.8,241.9,228.0,188.5,200.5,222.8,224.0,226.2,222.0,225.0,228.6,230.3,230.3,228.7,230.4,230.9,229.8,228.9,225.9,223.5,228.7,229.8,234.4,230.9,228.2,231.0,232.8,234.9,235.5,239.8,241.1,242.5,241.9,239.0,236.6,241.0,240.7,245.3,247.9,245.9,246.5,244.1,246.2,244.6,244.0,245.4,247.4,246.3,248.8,247.9,245.5,252.4,251.4,254.0,254.4,255.9,254.0,256.5,254.4,249.7,253.6,252.0,251.8,249.5,252.8,251.4,253.5,248.3],"public":[85.1,85.7,81.2,81.2,85.0,86.0,87.4,86.8,93.9,93.1,95.0,94.5,97.7,96.6,95.9,97.0,98.3,97.5,98.6,99.0,98.1,99.0,97.2,99.5,97.3,99.0,99.9,100.3,100.6,102.4,101.5,101.9,104.2,105.7,104.7,102.2,102.9,102.7,102.7,103.6,103.3,105.0,104.6,105.8,106.3,107.8,109.6,110.7,110.0,110.2,110.5,110.4,109.3,108.7,110.1,109.3,107.5,107.5,108.7,110.3,112.0,111.0,111.0,111.0,114.5,116.1,114.0,115.0]},
      "Newfoundland and Labrador": {"private":[147.5,146.9,141.3,112.4,113.5,125.5,127.1,132.6,137.8,138.0,138.6,135.1,136.8,125.5,134.9,136.3,133.5,137.2,137.6,136.5,135.1,138.3,145.4,141.3,136.6,144.0,143.4,144.2,147.1,144.1,144.4,145.4,145.5,146.9,147.0,148.9,146.5,144.7,146.6,147.6,145.0,145.3,148.4,149.4,150.0,150.2,150.8,152.5,156.9,155.6,155.4,154.4,153.8,156.1,155.9,154.3,154.2,153.6,152.2,152.7,152.4,153.4,152.1,155.1,154.7,153.0,153.9,151.9],"public":[63.9,62.4,62.2,62.5,65.2,63.5,63.3,64.2,66.9,69.4,70.3,72.3,73.5,70.4,68.2,70.2,70.5,69.9,72.0,71.2,72.4,71.9,72.0,71.3,72.4,71.4,71.0,70.4,70.6,72.2,71.4,71.2,70.6,69.2,70.5,71.5,71.1,73.1,72.8,71.6,71.3,73.1,72.1,71.9,70.7,72.3,71.7,70.4,72.5,71.7,72.0,74.2,73.7,72.5,72.1,71.8,71.5,71.2,70.8,72.6,73.0,71.8,74.8,75.6,75.6,75.7,74.6,72.7]},
      "Nova Scotia": {"private":[306.1,308.7,278.8,236.0,237.9,266.9,273.5,279.2,291.9,291.9,298.2,290.2,295.9,300.6,298.8,298.4,282.3,295.6,298.3,298.9,302.0,299.8,298.8,299.5,302.7,304.1,304.7,309.1,309.1,309.2,311.1,309.3,312.2,311.8,318.6,319.5,321.8,319.1,319.5,320.1,317.5,321.6,323.6,321.9,320.8,332.8,331.6,332.8,334.2,338.5,336.5,335.5,331.1,328.0,324.9,329.0,326.8,327.4,326.9,332.7,332.2,327.7,329.2,317.8,332.5,332.7,331.5,330.5],"public":[109.0,109.0,107.7,109.8,111.7,112.8,114.9,113.9,114.4,116.3,118.2,117.0,122.1,119.8,119.9,122.9,118.5,121.6,121.2,119.9,122.5,120.3,120.1,122.3,119.4,121.4,119.8,122.6,124.3,125.7,125.2,126.5,126.4,126.1,125.6,122.7,123.6,123.1,123.3,123.9,121.2,120.4,121.1,120.8,123.7,123.3,125.1,129.1,131.1,132.5,134.8,133.9,136.9,140.1,139.0,140.4,145.2,141.7,142.4,141.4,141.8,140.8,142.4,142.5,141.1,139.4,139.9,137.5]},
      "Ontario": {"private":[5000.8,5007.0,4625.5,3969.8,3970.5,4347.0,4514.5,4625.2,4799.5,4826.6,4852.8,4843.7,4652.3,4765.1,4866.7,4745.8,4690.5,4787.4,4872.4,4919.2,4972.2,5054.6,5093.0,5100.1,4956.4,5152.6,5152.7,5180.2,5155.1,5168.9,5173.2,5154.7,5138.4,5184.2,5195.8,5243.3,5292.5,5339.3,5349.9,5370.1,5368.6,5422.1,5405.3,5388.0,5394.5,5378.3,5381.4,5364.5,5374.9,5365.3,5398.9,5419.8,5434.4,5429.5,5439.2,5438.1,5468.1,5428.1,5421.1,5446.7,5481.3,5498.0,5472.0,5439.7,5454.4,5466.9,5454.9,5484.0],"public":[1360.3,1365.4,1301.9,1279.7,1276.2,1309.7,1313.7,1331.9,1352.5,1366.8,1357.8,1377.7,1371.5,1388.1,1431.3,1386.1,1404.1,1434.2,1449.8,1442.1,1495.1,1473.1,1507.7,1525.7,1515.9,1510.8,1515.9,1538.4,1557.7,1552.4,1544.9,1545.0,1551.0,1560.4,1551.7,1543.6,1540.5,1539.5,1549.4,1553.8,1550.0,1560.3,1583.8,1590.7,1593.7,1594.7,1591.7,1585.5,1609.5,1611.7,1615.9,1608.9,1620.2,1624.5,1625.3,1623.4,1620.0,1618.3,1633.1,1634.4,1635.4,1642.5,1639.1,1648.5,1626.3,1636.2,1645.3,1610.0]},
      "Prince Edward Island": {"private":[50.2,49.5,46.1,39.5,40.4,42.5,44.1,45.5,45.5,45.2,45.4,44.1,45.0,44.4,45.8,45.1,45.7,45.3,46.0,44.9,45.6,45.6,48.4,50.1,51.0,51.5,52.2,52.8,52.8,52.9,53.5,53.1,53.9,54.3,54.6,54.8,55.3,56.0,56.9,57.1,58.0,58.5,59.1,59.5,59.5,59.3,60.4,60.9,62.4,61.8,61.8,62.5,63.0,63.8,63.8,64.3,64.5,64.4,64.2,65.7,65.7,66.4,66.0,65.8,67.2,67.9,67.2,67.5],"public":[20.7,20.7,20.5,20.2,20.7,21.1,21.2,21.0,21.1,21.7,21.7,22.3,22.2,22.4,22.6,22.6,22.7,23.2,23.4,24.3,23.9,23.2,22.7,23.3,23.1,23.5,23.8,23.9,24.2,24.0,24.1,24.2,24.3,24.7,24.9,25.0,25.0,25.0,25.5,25.7,25.6,26.0,26.2,26.3,26.4,26.5,26.8,27.3,27.7,27.8,28.1,28.7,28.8,28.7,28.9,29.3,29.5,29.4,29.7,29.8,29.9,30.1,30.1,30.3,30.4,30.6,30.6,30.7]},
      "Quebec": {"private":[2965.0,2979.1,2754.5,2297.5,2537.4,2784.6,2840.7,2893.0,2966.8,2954.6,2943.6,2969.4,2780.8,2938.3,3030.6,2936.5,2875.4,2999.4,3035.5,3067.0,3107.0,3160.8,3159.3,3203.9,3042.7,3231.8,3252.0,3303.2,3251.2,3221.4,3254.8,3260.9,3249.1,3297.9,3315.7,3348.9,3384.6,3407.6,3436.6,3476.3,3484.2,3540.3,3553.2,3550.7,3576.9,3593.7,3613.6,3617.1,3581.7,3590.0,3581.5,3590.6,3584.7,3597.8,3553.0,3576.9,3605.9,3608.2,3611.4,3625.9,3656.5,3652.7,3640.5,3594.7,3631.9,3660.7,3648.9,3632.1],"public":[1081.4,1083.3,1020.7,987.8,1024.0,1031.6,1069.9,1104.7,1125.7,1135.5,1149.0,1164.8,1153.4,1177.5,1231.0,1205.7,1224.7,1253.3,1253.0,1264.8,1275.3,1268.3,1281.1,1296.6,1306.8,1309.1,1326.5,1323.2,1332.2,1336.5,1341.6,1344.6,1342.8,1349.2,1352.1,1348.1,1358.3,1359.8,1360.6,1365.1,1371.7,1374.5,1381.4,1398.5,1401.9,1409.6,1401.3,1407.3,1403.0,1404.5,1404.1,1406.8,1416.5,1416.6,1442.0,1443.9,1434.8,1439.5,1446.7,1460.9,1448.5,1455.4,1444.7,1457.2,1467.4,1468.5,1476.8,1478.0]},
      "Saskatchewan": {"private":[346.4,348.3,331.0,287.2,301.4,321.6,330.2,332.8,345.3,345.7,339.1,339.9,343.0,339.4,339.5,341.8,344.1,346.3,347.6,350.1,353.7,356.4,357.2,357.4,359.3,365.4,369.5,373.0,374.5,375.8,377.7,380.5,380.2,382.4,385.7,384.0,387.2,395.7,398.6,400.2,403.9,408.2,410.7,408.3,408.9,408.7,411.5,411.5,408.8,410.0,406.3,410.5,412.2,419.8,419.0,417.8,423.4,424.9,428.8,427.5,429.6,433.6,429.9,429.5,433.5,439.3,438.7,437.0],"public":[140.3,139.7,137.1,137.5,139.6,143.5,144.6,145.5,146.5,150.4,149.1,150.4,152.5,153.8,156.6,155.8,157.3,158.4,159.2,161.1,163.1,161.8,164.1,165.9,164.9,165.7,169.1,167.8,170.8,171.3,171.6,172.8,172.9,173.6,172.4,173.8,173.6,173.0,173.4,173.7,172.7,173.0,173.0,174.7,176.4,177.2,177.5,177.7,180.9,181.3,181.2,182.3,181.5,181.4,183.8,184.1,184.2,185.8,186.8,187.9,186.7,187.8,187.5,188.7,190.2,190.5,191.0,191.5]}
    };

    const dates = ['2020-01','2020-02','2020-03','2020-04','2020-05','2020-06','2020-07','2020-08','2020-09','2020-10','2020-11','2020-12','2021-01','2021-02','2021-03','2021-04','2021-05','2021-06','2021-07','2021-08','2021-09','2021-10','2021-11','2021-12','2022-01','2022-02','2022-03','2022-04','2022-05','2022-06','2022-07','2022-08','2022-09','2022-10','2022-11','2022-12','2023-01','2023-02','2023-03','2023-04','2023-05','2023-06','2023-07','2023-08','2023-09','2023-10','2023-11','2023-12','2024-01','2024-02','2024-03','2024-04','2024-05','2024-06','2024-07','2024-08','2024-09','2024-10','2024-11','2024-12','2025-01','2025-02','2025-03','2025-04','2025-05','2025-06','2025-07','2025-08'];
    // Earth-tone palette derived from Canada Central design system
    const colors = ['#A13F3F','#4A7A4A','#3A5F8F','#C47A3F','#7C5A9D','#3A8F8F','#6B3838','#C49A6C','#3A5F6F','#8B6914'];

    let chart, view = 'indexed', provinceKeys = Object.keys(provincialData);

    // Populate province chips
    const provContainer = document.getElementById('provinces');
    const toggleAll = document.createElement('span');
    toggleAll.className = 'chip-toggle';
    toggleAll.textContent = 'All / None';
    toggleAll.onclick = () => {
      const chips = provContainer.querySelectorAll('.chip');
      const allOn = Array.from(chips).every(c => c.classList.contains('on'));
      chips.forEach(c => c.classList.toggle('on', !allOn));
      update();
    };
    provContainer.appendChild(toggleAll);

    provinceKeys.forEach((k, idx) => {
      const chip = document.createElement('span');
      chip.className = 'chip on';
      chip.dataset.prov = k;
      chip.textContent = k;
      const c = colors[idx % colors.length];
      chip.style.borderColor = c;
      chip.style.background = c;
      chip.style.color = '#fff';
      chip.onclick = () => { chip.classList.toggle('on'); update(); };
      provContainer.appendChild(chip);
    });

    function setView(v, e) {
      view = v;
      document.querySelectorAll('.controls .btn-filter').forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      update();
    }

    function calcMoM(arr) {
      return arr.map((v, i) => i === 0 ? null : ((v - arr[i-1]) / arr[i-1] * 100).toFixed(2));
    }

    function calcIndexed(arr) {
      return arr.map(v => (v / arr[0] * 100).toFixed(1));
    }

    function update() {
      const sector = document.getElementById('sector').value;
      const selected = Array.from(provContainer.querySelectorAll('.chip.on')).map(c => c.dataset.prov);

      const datasets = [];
      selected.forEach(prov => {
        const ci = provinceKeys.indexOf(prov);
        const color = colors[ci % colors.length];
        const priv = provincialData[prov].private;
        const pub = provincialData[prov].public;

        if (sector === 'both' || sector === 'private') {
          let data = priv;
          if (view === 'mom') data = calcMoM(priv);
          if (view === 'indexed') data = calcIndexed(priv);
          if (view === 'share') data = priv.map((p, i) => (p / (p + pub[i]) * 100).toFixed(1));

          datasets.push({
            label: prov + ' Private',
            data: data,
            borderColor: color,
            borderWidth: 2,
            pointRadius: 0,
            fill: false,
            tension: 0.3
          });
        }

        if (sector === 'both' || sector === 'public') {
          let data = pub;
          if (view === 'mom') data = calcMoM(pub);
          if (view === 'indexed') data = calcIndexed(pub);
          if (view === 'share') data = pub.map((p, i) => (p / (priv[i] + p) * 100).toFixed(1));

          datasets.push({
            label: prov + ' Public',
            data: data,
            borderColor: color,
            borderWidth: 2,
            pointRadius: 0,
            borderDash: [5, 5],
            fill: false,
            tension: 0.3
          });
        }
      });

      if (chart) chart.destroy();

      const ctx = document.getElementById('chart').getContext('2d');
      chart = new Chart(ctx, {
        type: 'line',
        data: { labels: dates, datasets: datasets },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: { position: 'top', labels: { boxWidth: 15, font: { size: 10 }, color: '#5A5A5A' } },
            title: { display: true, text: view === 'mom' ? 'Month-over-Month %' : view === 'indexed' ? 'Indexed (Jan 2020 = 100)' : view === 'share' ? 'Share of Total Employment %' : 'Employment (thousands)', color: '#2D2D2D', font: { size: 13, weight: 600 } },
            tooltip: {
              mode: 'index',
              intersect: false,
              itemSort: (a, b) => b.parsed.y - a.parsed.y,
              callbacks: {
                label: ctx => {
                  const v = ctx.parsed.y;
                  return v != null ? ' ' + ctx.dataset.label + ': ' + v : null;
                }
              }
            }
          },
          hover: {
            mode: 'index',
            intersect: false
          },
          scales: {
            y: {
              beginAtZero: view === 'share',
              min: view === 'indexed' ? 70 : undefined,
              max: view === 'share' ? 100 : undefined,
              ticks: { color: '#5A5A5A' },
              grid: { color: '#E8E2D5' }
            },
            x: {
              ticks: { maxRotation: 45, minRotation: 45, font: { size: 9 }, color: '#5A5A5A' },
              grid: { color: '#E8E2D5' }
            }
          }
        }
      });
    }

    update();
  </script>
</body>
</html>
